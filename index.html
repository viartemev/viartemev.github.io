<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Колода Карт Таро</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #1a472a;
        }
        .deck {
            width: 200px;
            height: 300px;
            position: relative;
            cursor: pointer;
            perspective: 1000px;
        }
        .card-back {
            width: 200px;
            height: 300px;
            background-color: white;
            border-radius: 10px;
            position: absolute;
            top: 0;
            left: 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .card-back:nth-child(2) { transform: translate(1px, 1px) rotate(0.5deg); }
        .card-back:nth-child(3) { transform: translate(2px, 2px) rotate(1deg); }
        .card-back:nth-child(4) { transform: translate(3px, 3px) rotate(1.5deg); }
        .card-back:nth-child(5) { transform: translate(4px, 4px) rotate(2deg); }
        .card {
            width: 200px;
            height: 300px;
            position: absolute;
            top: 0;
            left: 0;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .card-face, .card-back {
            width: 100%;
            height: 100%;
            position: absolute;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .card-face {
            background-color: white;
            transform: rotateY(180deg);
        }
        .card.flipped {
            transform: rotateY(180deg) translateX(50px);
        }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="deck" id="deck">
        <div class="card-back"></div>
        <div class="card-back"></div>
        <div class="card-back"></div>
        <div class="card-back"></div>
        <div class="card-back"></div>
        <div class="card" id="card">
            <div class="card-back"></div>
            <div class="card-face" id="card-face"></div>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        const tarotCards = [
            "Шут", "Маг", "Верховная Жрица", "Императрица", "Император",
            "Иерофант", "Влюбленные", "Колесница", "Сила", "Отшельник",
            "Колесо Фортуны", "Справедливость", "Повешенный", "Смерть",
            "Умеренность", "Дьявол", "Башня", "Звезда", "Луна", "Солнце",
            "Суд", "Мир"
        ];

        const deck = document.getElementById('deck');
        const card = document.getElementById('card');
        const cardFace = document.getElementById('card-face');
        let isFlipped = false;

        function callTelegram(cardName) {
            tg.sendData(cardName);
            tg.close();
        }

        deck.addEventListener('click', () => {
            if (!isFlipped) {
                const randomCard = tarotCards[Math.floor(Math.random() * tarotCards.length)];
                cardFace.textContent = randomCard;
                card.classList.add('flipped');
                isFlipped = true;
                setTimeout(() => callTelegram(randomCard), 2000); // Вызываем после завершения анимации
            } else {
                card.classList.remove('flipped');
                isFlipped = false;
                setTimeout(() => cardFace.textContent = '', 300); // Очищаем текст когда карта перевернута обратно
            }
        });
    </script>
</body>
</html>
